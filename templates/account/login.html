{% extends "account/_base.html" %}

{% load i18n %}
{% load widget_tweaks %}

{% block title %}
  {% trans "Sign in" %}
{% endblock title %}
{% block content_header %}
  <div class="vstack align-items-center gap-2 mb-6">
    <h1>
      {% trans "Sign in" %}
    </h1>
    {% if ACCOUNT_ALLOW_REGISTRATION %}
      <p>
        {% blocktrans trimmed %}
          Don't have an account yet? <a href="{{ signup_url }}">Register here</a>
        {% endblocktrans %}
      </p>
    {% else %}
      <p>
        {% blocktrans trimmed %}
          Please enter your credentials to sign in.
        {% endblocktrans %}
      </p>
    {% endif %}
  </div>
{% endblock content_header %}
{% block content_body %}
  {{ block.super }}
  {% url 'account_login' as login_url %}
  {% url 'account_reset_password' as password_reset_url %}
  {% trans "Email address" as email_label %}
  {% trans "Password" as password_label %}
  {% with WIDGET_ERROR_CLASS="border-danger" %}
    <form method="post"
          class="vstack gap-6"
          action="{{ login_url }}"
          novalidate>
      {% csrf_token %}
      {{ redirect_field }}
      <div class="vstack gap-1">
        <div class="position-relative">
          <i class="ai-mail fs-lg position-absolute top-50 start-0 translate-middle-y ms-4"></i>
          {% render_field form.login class="form-control form-control-lg ps-12" placeholder=email_label autocomplete="username" inputmode="email" autofocus="autofocus" %}
        </div>
        {% if form.login.errors %}
          <div class="invalid-feedback d-block">
            <ul class="list-unstyled mb-0">
              {% for error in form.login.errors %}
                <li>
                  {{ error }}
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}
      </div>
      <div class="vstack gap-1">
        <div class="position-relative">
          <i class="ai-lock-closed fs-lg position-absolute top-50 start-0 translate-middle-y ms-4"></i>
          <div class="password-toggle">
            {% render_field form.password class="form-control form-control-lg ps-12" placeholder=password_label autocomplete="current-password" %}
            <label class="password-toggle-btn">
              <input type="checkbox" class="password-toggle-check" />
              <span class="password-toggle-indicator"></span>
            </label>
          </div>
        </div>
        {% if form.password.errors %}
          <div class="invalid-feedback d-block">
            <ul class="list-unstyled mb-0">
              {% for error in form.password.errors %}
                <li>
                  {{ error }}
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}
      </div>
      <div class="d-flex flex-wrap justify-content-between align-items-center">
        {% if form.remember %}
          <div class="form-check">
            {% render_field form.remember class="form-check-input" %}
            <label for="{{ form.remember.id_for_label }}" class="form-check-label">
              {% trans "Remember me" %}
            </label>
          </div>
        {% endif %}
        <a href="{{ password_reset_url }}">
          {% trans "Forgot password?" %}
        </a>
      </div>
      <button type="submit" class="btn btn-lg btn-primary">
        {% trans "Sign in" %}
      </button>
    </form>
  {% endwith %}
{% endblock content_body %}
{% block content_footer %}
  {% if LOGIN_BY_CODE_ENABLED %}
    <div class="vstack align-items-center gap-6 mt-8">
      <div class="fs-6 text-muted">
        {% trans "or" %}
      </div>
      <a href="{{ request_login_code_url }}">
        {% trans "Sign in with a login code" %}
      </a>
    </div>
  {% endif %}
{% endblock content_footer %}
