{% extends "account/_base.html" %}

{% load i18n %}
{% load widget_tweaks %}

{% block title %}
  {% trans "Password reset" %}
{% endblock title %}
{% block content_header %}
  <div class="vstack align-items-center gap-2 mb-6">
    <h1>
      {% trans "Password reset" %}
    </h1>
    <p>
      {% blocktrans trimmed %}
        Forgotten your password? Enter your email address below, and we'll
        send you an email allowing you to reset it.
      {% endblocktrans %}
    </p>
  </div>
{% endblock content_header %}
{% block content_body %}
  {{ block.super }}
  {% url 'account_reset_password' as password_reset_url %}
  {% url 'store:index' as home_url %}
  {% url 'account_login' as login_url %}
  {% with WIDGET_ERROR_CLASS="border-danger" %}
    {% trans "Email address" as email_label %}
    <form method="post"
          class="vstack gap-6"
          action="{{ password_reset_url }}"
          novalidate>
      {% csrf_token %}
      {{ redirect_field }}
      <div class="vstack gap-1">
        {% render_field form.email class="form-control form-control-lg" placeholder=email_label autofocus="autofocus" autocomplete="email" %}
        {% if form.email.errors %}
          <div class="invalid-feedback d-block">
            <ul class="list-unstyled mb-0">
              {% for error in form.email.errors %}
                <li>
                  {{ error }}
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}
      </div>
      <button type="submit" class="btn btn-lg btn-primary">
        {% trans "Reset my password" %}
      </button>
      {% if user.is_authenticated %}
        <a href="{{ home_url }}" class="btn btn-lg btn-secondary">
          {% trans "Return to home" %}
        </a>
      {% else %}
        <a href="{{ login_url }}" class="btn btn-lg btn-secondary">
          {% trans "Return to login" %}
        </a>
      {% endif %}
    </form>
  {% endwith %}
{% endblock content_body %}
